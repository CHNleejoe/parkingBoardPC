webpackJsonp([1],{"9bBU":function(t,e,a){a("mClu");var r=a("FeBl").Object;t.exports=function(t,e,a){return r.defineProperty(t,e,a)}},C4MV:function(t,e,a){t.exports={default:a("9bBU"),__esModule:!0}},JfD8:function(t,e){},bOdI:function(t,e,a){"use strict";e.__esModule=!0;var r,i=a("C4MV"),n=(r=i)&&r.__esModule?r:{default:r};e.default=function(t,e,a){return e in t?(0,n.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},mClu:function(t,e,a){var r=a("kM2E");r(r.S+r.F*!a("+E39"),"Object",{defineProperty:a("evD5").f})},mvHQ:function(t,e,a){t.exports={default:a("qkKv"),__esModule:!0}},qkKv:function(t,e,a){var r=a("FeBl"),i=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},vkyI:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("mvHQ"),i=a.n(r),n=a("bOdI"),s=a.n(n),o=a("oqQY"),l=a.n(o),c={data:function(){var t;return t={dataList:[{label:"进出车辆总量",labelStr:"total",icon:"./static/imgs/car.png",unit:"辆",herf:"inOut",expend:{inOut:0},display:!0,point:!0},{label:"进场车辆总量",labelStr:"enter",icon:"./static/imgs/out.png",unit:"辆",herf:"inOut",expend:{inOut:1},display:!0,point:!0},{label:"出场车辆总量",labelStr:"out",icon:"./static/imgs/out-yellow.png",unit:"辆",herf:"inOut",expend:{inOut:2},display:!0,point:!0},{label:"在场车辆总数",labelStr:"curr",icon:"./static/imgs/parking-red.png",unit:"辆",herf:"inParking",display:"hasParkingData",point:!0},{label:"停车场总车位数",labelStr:"parkPlaceNum",icon:"./static/imgs/parking.png",unit:"个",herf:"",display:!0,point:!1},{label:"剩余车位数",labelStr:"leftPlaceNum",icon:"./static/imgs/parking-green.png",unit:"个",herf:"",display:"hasParkingData",point:!1},{label:"收到停车费",labelStr:"price",icon:"./static/imgs/money.png",unit:"元",herf:"charge",display:!0,point:!0}],boardData:{total:0,price:0,enter:0,curr:0,out:0,parkPlaceNum:0,leftPlaceNum:0},dateTypePopupCtl:!1,dateTypeColumns:[{label:"今日",value:0},{label:"本月",value:1},{label:"本年",value:2},{label:"自定义",value:3}],dateTypeIndex:0,displayStartDate:new Date,startDate:l()(new Date),displayEndDate:new Date,endDate:l()(new Date),startDatePopupCtl:!1,endDatePopupCtl:!1,carTypeData:{}},s()(t,"carTypeData",{}),s()(t,"trafficFlowData",{}),s()(t,"chargeData",{}),s()(t,"hasParkingData",!0),s()(t,"timer",0),t},watch:{dateTypeIndex:function(t){switch(t){case 0:this.startDate=new Date,this.endDate=new Date;break;case 1:this.startDate=l()(new Date).startOf("month"),this.endDate=l()(new Date).endOf("month");break;case 2:this.startDate=l()(new Date).startOf("year"),this.endDate=l()(new Date).endOf("year")}}},components:{},mounted:function(){console.log("board mounted ----");this.searchAllData()},methods:{goBack:function(){window.location.href="epipe://?&mark=history_back",localStorage.clear()},formatter:function(t,e){return"year"===t?e+"年":"month"===t?e+"月":e},setStartDate:function(t){this.startDate=t,this.dateTypeIndex=3},setEndDate:function(t){this.endDate=t,this.dateTypeIndex=3},confirmDateType:function(t,e){if(3==e||e!=this.dateTypeIndex){switch(this.dateTypeIndex=e,e){case 0:case 4:this.startDate=l()(new Date).format("YYYY-MM-DD"),this.endDate=l()(new Date).format("YYYY-MM-DD");break;case 1:this.startDate=l()(new Date).format("YYYY/MM"),this.endDate=l()(new Date).format("YYYY/MM");break;case 2:this.startDate=l()(new Date).format("YYYY"),this.endDate=l()(new Date).format("YYYY")}this.searchAllData(),this.dateTypePopupCtl=!1}else this.dateTypePopupCtl=!1},day:function(t){return new Date(t)},turnPage:function(t){if(""!=t.herf){var e=l()(this.startDate).format("YYYY-MM-DD"),a=l()(this.endDate).format("YYYY-MM-DD");1==this.dateTypeIndex?(e=l()(e).format("YYYY-MM-DD"),a=l()(a).endOf("month").format("YYYY-MM-DD")):2==this.dateTypeIndex?(e=l()().startOf("month").format("YYYY-MM-DD"),a=l()().endOf("month").format("YYYY-MM-DD")):3==this.dateTypeIndex&&Math.abs(l()(e).diff(l()(a),"day"))>30&&(e=l()(a).subtract(1,"month").format("YYYY-MM-DD")),window.open(this.Service.baseUrl+t.herf+"?startDate="+e+"&endDate="+a+"&expend="+i()(t.expend),"_blank")}},searchAllData:function(){this.requestGetBoard(),this.requestGetUserTypeList(),this.requestGetUserPriceList(),this.requestGetCarFlowList(),this.requestGetPriceFlowList()},formatDateParams:function(){var t=this,e={},a=this;if(l()(l()(a.startDate).format("YYYY-MM-DD"))>l()(l()(a.endDate).format("YYYY-MM-DD")))return clearTimeout(a.timer),a.timer=setTimeout(function(){t.$message({message:"开始时间不能大于结束时间",type:"warning"}),a.startDate=a.endDate},100),!1;switch(a.dateTypeIndex){case 0:e.startTime=l()(a.startDate).format("YYYY-MM-DD"),e.endTime=l()(a.endDate).format("YYYY-MM-DD");break;case 1:e.startTime=l()(a.startDate).format("YYYY-MM"),e.endTime=l()(a.endDate).format("YYYY-MM");break;case 2:e.startTime=l()(a.startDate).format("YYYY"),e.endTime=l()(a.endDate).format("YYYY");break;case 3:e.startTime=l()(a.startDate).format("YYYY-MM-DD"),e.endTime=l()(a.endDate).format("YYYY-MM-DD")}return e},requestGetBoard:function(){var t=this,e=t.formatDateParams();e&&t.$api.getBoard(e).then(function(e){console.log("getBoard:",e),200==e.h.code?(t.boardData=e.b,t.hasParkingData=l()(t.startDate).format("YYYY-MM-DD")==l()(t.endDate).format("YYYY-MM-DD")&&l()(t.startDate).format("YYYY-MM-DD")==l()().format("YYYY-MM-DD")):t.$message.error(e.h.msg)})},requestGetUserTypeList:function(){var t=this,e=t.formatDateParams();e&&t.$api.getUserTypeList(e).then(function(e){console.log("getUserTypeList:",e),200==e.h.code?(t.userTypeData=e.b,t.renderUserTypeChart()):t.$message.error(e.h.msg)})},renderUserTypeChart:function(){var t=echarts.init(document.getElementById("userTypeChart")),e=[],a=[];this.userTypeData.map(function(t){e.push({value:t.total,name:t.userType}),a.push(t.userType)});var r={title:{text:"车辆进出用户类型统计",left:"center",textStyle:{color:"white",lineHeight:58}},color:["#767EFF","#FEC400","#F65B62","#43E97D","#B620E0"],tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"horizontal",itemGap:10,left:"center",top:58,data:a,icon:"circle",textStyle:{color:"#fff"}},series:[{name:"进出用户",type:"pie",radius:[0,"65%"],left:"center",top:"20%",height:"360",width:"360",label:{formatter:"{b}\n({d}%)",fontSize:10},labelLine:{show:!0},data:e}]};t.setOption(r)},requestGetUserPriceList:function(){var t=this,e=t.formatDateParams();e&&t.$api.getUserPriceList(e).then(function(e){console.log("getUserTypeList:",e),200==e.h.code?(t.carTypeData=e.b,t.renderCarTypeChart()):t.$message.error(e.h.msg)})},renderCarTypeChart:function(){var t=echarts.init(document.getElementById("carTypeChart")),e=[],a=[];this.carTypeData.map(function(t){e.push({value:t.price,name:t.userType}),a.push(t.userType)});var r={color:["#767EFF","#FEC400","#F65B62","#43E97D","#B620E0"],title:{text:"车辆收费用户类型统计",left:"center",textStyle:{color:"white",lineHeight:58}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"horizontal",itemGap:10,left:"center",top:58,data:a,icon:"circle",textStyle:{color:"#fff"}},series:[{name:"收费用户",type:"pie",radius:[0,"65%"],left:"center",top:"20%",height:"360",width:"360",label:{formatter:"{b}\n({d}%)",fontSize:10},labelLine:{show:!0},data:e}]};t.setOption(r)},requestGetCarFlowList:function(){var t=this,e=t.formatDateParams();console.error(e),e&&t.$api.getCarFlow(e).then(function(e){console.log("getCarFlow:",e),200==e.h.code?(t.trafficFlowData=e.b,t.renderTrafficFlowChart()):t.$message.error(e.h.msg)})},renderTrafficFlowChart:function(){var t=this,e=echarts.init(document.getElementById("trafficFlowChart")),a=[],r=[{name:"进出场车辆总数",type:"line",areaStyle:{},data:[]},{name:"进场车辆数",type:"line",areaStyle:{},data:[]},{name:"出场车辆数",type:"line",areaStyle:{},data:[]}];console.warn(t.dateTypeIndex),t.trafficFlowData.map(function(e){0==t.dateTypeIndex||3==t.dateTypeIndex&&l()(t.startDate).format("YYYY-MM-DD")==l()(t.endDate).format("YYYY-MM-DD")?a.push(l()(e.time).hour()+"点"):1==t.dateTypeIndex||3==t.dateTypeIndex?a.push(l()(e.time).format("D")+"号"):a.push(l()(e.time).format("M")+"月"),r[0].data.push(e.totalCount),r[1].data.push(e.enterCount),r[2].data.push(e.outCount)});var i={color:["#767EFF","#FEC400","#F65B62","#43E97D","#B620E0"],title:{text:"车流实时趋势",left:"center",textStyle:{color:"white"}},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{orient:"horizontal",itemGap:5,left:"center",top:30,itemWidth:40,itemHeight:6,data:["进出场车辆总数","进场车辆数","出场车辆数"],icon:"roundRect",textStyle:{color:"#fff"}},grid:{top:"80",left:"0%",right:"8%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,color:"#fff",data:a,splitLine:{lineStyle:{opacity:.2}},axisLabel:{color:"#fff",interval:3,showMaxLabel:!0}}],yAxis:[{type:"value",splitLine:{lineStyle:{opacity:.2}},axisLabel:{color:"#fff",formatter:"{value} 个"}}],series:r};e.setOption(i)},requestGetPriceFlowList:function(){var t=this,e=t.formatDateParams();e&&t.$api.getPriceFlow(e).then(function(e){console.log("getPriceFlow:",e),200==e.h.code?(t.chargeData=e.b,t.renderChargeChart()):t.$message.error(e.h.msg)})},renderChargeChart:function(){var t,e=this,a=echarts.init(document.getElementById("chargeChart")),r=[],i=[{name:"总收费",type:"line",areaStyle:{},data:[]},{name:"月卡收费",type:"line",areaStyle:{},data:[]},{name:"临时车收费",type:"line",areaStyle:{},data:[]}];e.chargeData.map(function(t){0==e.dateTypeIndex||3==e.dateTypeIndex&&l()(e.startDate).format("YYYY-MM-DD")==l()(e.endDate).format("YYYY-MM-DD")?r.push(l()(t.time).hour()+"点"):1==e.dateTypeIndex||3==e.dateTypeIndex?r.push(l()(t.time).format("D")+"号"):r.push(l()(t.time).format("M")+"月"),i[0].data.push(t.totalPrice),i[1].data.push(t.vipPrice),i[2].data.push(t.tempPrice)});var n={color:["#767EFF","#FEC400","#F65B62","#43E97D","#B620E0"],title:{text:"停车场收费趋势",left:"center",textStyle:{color:"white"}},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{orient:"horizontal",itemGap:10,left:"center",top:30,itemWidth:40,itemHeight:6,data:["总收费","月卡收费","临时车收费"],icon:"roundRect",textStyle:{color:"#fff"}},grid:{left:"5%",right:"3%",bottom:"3%",top:"80",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,color:"#fff",splitLine:{lineStyle:{opacity:.2}},data:r,axisLabel:(t={color:"#fff",interval:"auto"},s()(t,"interval",3),s()(t,"showMaxLabel",!0),t)}],yAxis:[{type:"value",splitLine:{lineStyle:{opacity:.2}},axisLabel:{color:"#fff",formatter:"{value} 元"}}],series:i};a.setOption(n)}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-box"},[a("div",{staticClass:"search"},[a("div",{staticClass:"selects"},[a("el-select",{staticClass:"type",attrs:{placeholder:"请选择时间类型"},model:{value:t.dateTypeIndex,callback:function(e){t.dateTypeIndex=e},expression:"dateTypeIndex"}},t._l(t.dateTypeColumns,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),a("el-date-picker",{staticClass:"datepicker",attrs:{type:"date",placeholder:"选择开始日期"},on:{change:t.setStartDate},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}),t._v(" "),a("div",{staticClass:"double-line"}),t._v(" "),a("el-date-picker",{staticClass:"datepicker",attrs:{type:"date",placeholder:"选择结束日期"},on:{change:t.setEndDate},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1),t._v(" "),a("div",{staticClass:"btns"},[a("el-button",{staticClass:"search-btn",attrs:{type:"primary"},on:{click:t.searchAllData}},[t._v("查询")])],1)]),t._v(" "),a("div",{staticClass:"datas"},t._l(t.dataList,function(e,r){return a("div",{directives:[{name:"show",rawName:"v-show",value:"hasParkingData"!=e.display||t.hasParkingData,expression:"item.display == 'hasParkingData'?hasParkingData:true"}],key:r,class:{"data-item":!0,point:e.point,nomar:t.hasParkingData&&4==r||!t.hasParkingData&&6==r},on:{click:function(a){return t.turnPage(e)}}},[a("div",{staticClass:"img"},[a("img",{attrs:{src:e.icon,alt:""}})]),t._v(" "),a("div",{staticClass:"detail"},[a("div",{staticClass:"label"},[t._v(t._s(e.label))]),t._v(" "),a("div",{staticClass:"num"},[t._v(t._s(t.boardData[e.labelStr])+t._s(e.unit))])])])}),0),t._v(" "),t._m(0)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"charts"},[e("div",{staticClass:"user-type chart-item"},[e("div",{attrs:{id:"userTypeChart"}})]),this._v(" "),e("div",{staticClass:"car-type chart-item"},[e("div",{attrs:{id:"carTypeChart"}})]),this._v(" "),e("div",{staticClass:"traffic-flow chart-item"},[e("div",{attrs:{id:"trafficFlowChart"}})]),this._v(" "),e("div",{staticClass:"charge chart-item"},[e("div",{attrs:{id:"chargeChart"}})])])}]};var p=a("VU/8")(c,d,!1,function(t){a("JfD8")},"data-v-614fb1bf",null);e.default=p.exports}});
//# sourceMappingURL=1.70d3afddfbd417c9894a.js.map